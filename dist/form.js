!function(){"use strict";var e=new function(){var e,t,n,o,i;window.fbAsyncInit=function(){FB.init({appId:chromaApp.fbAppID,autoLogAppEvents:!0,xfbml:!0,version:"v3.2"})},e=document,t="script",n="facebook-jssdk",i=e.getElementsByTagName(t)[0],e.getElementById(n)||((o=e.createElement(t)).id=n,o.src="https://connect.facebook.net/en_US/sdk.js",i.parentNode.insertBefore(o,i)),this.fbLogin=function(e){FB.login((function(t){!function(e){FB.getLoginStatus((function(t){!function(e,t){"connected"===e.status&&(console.log("user logged in and ready to submit data"),formProceszr.facebookSignup(t))}(t,e)}))}(e)}),{scope:"email"})}};var t=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=location.protocol+"//"+window.location.hostname+"/wp-json/chroma/form-processer/",o=encodeURI(window.location);function i(e){fetch(n,{method:"post",headers:{"Content-type":"application/x-www-form-urlencoded; charset=UTF-8"},body:"&email="+e+"&type="+(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"subscribe")+"&currURL="+o}).then((function(e){return e.text()})).then((function(e){var n=e;if(a(n)&&null!==t){var o='["Already Subscribed!"'===n.split(",")[0];t(o)}})).catch((function(e){return console.log("Form submission error: "+e)}))}function a(e){if(e=e.split(","),Array.isArray(e)){for(var t=0,n=e.length;t<n;t++)e[t]=e[t].replace(/"/g,""),e[t]=e[t].replace(/]/g,""),e[t]=e[t].replace(/\[/g,"");var o=document.getElementById("errorMessage"),i=document.getElementById("errorMessage2");o.classList.remove("is-active"),o.innerText=e[0],i.innerText=e[1],o.classList.add("is-active")}else{e=e.replace(/"/g,"");var a=document.getElementById("errorMessage");a.classList.remove("is-active"),a.innerText=e,a.classList.add("is-active")}return!0}this.facebookSignup=function(e){FB.api("/me","GET",{fields:"id,name,email"},(function(o){window.location.hostname;var i=encodeURI(window.location),c="&email=".concat(o.email,"&type=fblogin&currURL=").concat(i);fetch(n,{method:"post",headers:{"Content-type":"application/x-www-form-urlencoded; charset=UTF-8"},body:c}).then((function(e){return e.text()})).then((function(n){var o=n;if(a(o)&&null!==t){var i='["Already Subscribed!"'===o.split(",")[0];t(i)}null!==e.getAttribute("data-next")&&-1!==e.getAttribute("data-next").indexOf("http")&&(window.location=e.getAttribute("data-next"))})).catch((function(e){alert("Facebook Login Error. Please try again later."),console.log(o)}))}))},this.init=function(){try{if(doesExist(document.getElementById("subscribe"))){var t=document.getElementById("subscribe");t.addEventListener("submit",(function(e){e.preventDefault();var n=t.getAttribute("data-type");n=null!==n?n:"subscribe",i(document.getElementById("subscribeEmail").value,n)}))}document.getElementsByClassName("fb-arrow").length>0&&[].forEach.call(document.getElementsByClassName("fb-arrow"),(function(t){t.addEventListener("click",(function(n){n.preventDefault(),e.fbLogin(t)}))})),doesExist(document.getElementById("unsub"))&&document.getElementById("unsub").addEventListener("submit",(function(e){e.preventDefault(),i(document.getElementById("unsubEmail").value,"unsubscribe")}))}catch(e){console.log(e)}}};(new t).init()}();